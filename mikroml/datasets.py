# AUTOGENERATED! DO NOT EDIT! File to edit: ../mikroml_notebooks/05_datasets.ipynb.

# %% auto 0
__all__ = ['MNIST_URL', 'MNIST_Dataset']

# %% ../mikroml_notebooks/05_datasets.ipynb 2
MNIST_URL = "https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/data/mnist.pkl.gz?raw=true"

from pathlib import Path
from urllib import request
import gzip, pickle

class MNIST_Dataset():
    
    def __init__(self, data_path=None):
        if data_path:
            self.data_path = data_path
        else:
            self.data_path = Path.home() / ".cache/mnist_data/"
        self.data_path.mkdir(parents=True, exist_ok=True)
        self.data_file = self.data_path/"mnist.pkl.gz"
        
        if not self.data_file.exists():
            response = request.urlretrieve(MNIST_URL, self.data_path/"mnist.pkl.gz")
        data = gzip.open(self.data_file)
        with gzip.open(self.data_file, mode="rb") as f:
            self.train_set, self.valid_set, self.test_set = pickle.load(f, encoding="latin-1")
            self.train_x = self.train_set[0]
            self.train_y = self.train_set[1]
            self.valid_x = self.valid_set[0]
            self.valid_y = self.valid_set[1]
